# Chrome 架构

## 思维导图

![](/MindMap/Browser/Chrome架构.png)

## 讨论

1. **即使是如今的多进程架构，我偶尔还会碰到一些由于单个页面卡死最终崩溃导致所有页面崩溃的情况，请问这是什么原因呢？**

   作者回复: 是这样的，通常情况下是一个页面使用一个进程，但是，有一种情况，叫"同一站点(`same-site`)"，具体地讲，我们将“同一站点”定义为根域名（例如，`geekbang.org`）加上协议（例如，`https://` 或者`http://`），还包含了该根域名下的所有子域名和不同的端口，比如下面这三个：

   `https://time.geekbang.org; https://www.geekbang.org; https://www.geekbang.org:8080`

   都是属于同一站点，因为它们的协议都是 https，而根域名也都是 `geekbang.org`。你也许了解同源策略，但是同一站点和同源策略还是存在一些不同地方，在这里你需要了解它们不是同一件事就行了。

   `Chrome` 的默认策略是，每个标签对应一个渲染进程。但是如果从一个页面打开了新页面，而新页面和当前页面属于同一站点时，那么新页面会复用父页面的渲染进程。官方把这个默认策略叫 `process-per-site-instance`。

   直白的讲，就是如果几个页面符合同一站点，那么他们将被分配到一个渲染进程里面去。

   所以，这种情况下，一个页面崩溃了，会导致同一站点的页面同时崩溃，因为他们使用了同一个渲染进程。

   为什么要让他们跑在一个进程里面呢？

   因为在一个渲染进程里面，他们就会共享 `JS` 的执行环境，也就是说 `A` 页面可以直接在 `B` 页面中执行脚本。因为是同一家的站点，所以是有这个需求的。
